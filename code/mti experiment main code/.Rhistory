source('H:/git/zeit-2/code/mti experiment main code/evaluation.R', echo=TRUE)
data$eval=is.na(data$'IP')==F&is.na(data$'set-target')==F
target.df=data[data$eval,c(target,'set-target')]
res.file=paste('H:/git/zeit-2/Results/IP_h',h,'.RData',sep='')
load(res.file)
# forecasts
fc=sapply(forecast.all,function(x)x$fc)
# dropping vintages that can not be used
fc=fc[,1:nrow(target.df)]
targetm=t(matrix(rep(target.df[,target],nrow(fc)),ncol=nrow(fc)))
dim(fc)
fe=fc-targetm
View(targetm)
View(fc)
str(targetm)
fe=fc-matrix(targetm)
str(fc)
fc=as.numeric(fc[,1:nrow(target.df)])
targetm=t(matrix(rep(target.df[,target],nrow(fc)),ncol=nrow(fc)))
fc=(fc[,1:nrow(target.df)])
rm(fc)
fc=fc[,1:nrow(target.df)]
fc=sapply(forecast.all,function(x)x$fc)
# dropping vintages that can not be used
fc=fc[,1:nrow(target.df)]
dimfc=dim(fc)
fc=sapply(forecast.all,function(x) as.numeric(x$fc))
# dropping vintages that can not be used
fc=fc[,1:nrow(target.df)]
targetm=t(matrix(rep(target.df[,target],nrow(fc)),ncol=nrow(fc)))
fe=fc-targetm
View(fe)
modn=sapply(forecast.all,function(x) row.names(x))
View(modn)
modn=row.names(forecast.all[[1]]
modn=row.names(forecast.all[[1]])
row.names(fc)=modn
targetm=t(matrix(rep(target.df[,target],nrow(fc)),ncol=nrow(fc)))
fe=fc-targetm
View(fe)
sfe=fc^2
mse=rowMeans(sfe)
rmse=mse^.5
View(rmse)
result=data.frame(mse=rowMeans(sfe),
rmse=mse^.5)
result$rank.rmse=rank(rmse)
View(result)
result$rank.rmse=round(rank(rmse),1)
View(result)
result$rank.rmse=round(rank(rmse),0)
View(result)
grep('MT.',row.names(result))
result.mt=result[grep('MT.',row.names(result)),]
View(result.mt)
rk.period=apply(sfe,2,rank)
View(rk.period)
rowSums(rk.period)
colSums(rk.period)
sum(1:171)
result=data.frame(mse=rowMeans(sfe),
rmse=mse^.5
rank.mean=rowMeans(rk.period)
)
result$rank.rmse=round(rank(rmse),0)
result$rank.rank.mean=round(rank(rank.mean),0)
result$rank.rank.mean=round(rank(result$rank.mean),0)
result$rank.mean)
result$rank.mean
result=data.frame(mse=rowMeans(sfe),
rmse=mse^.5
rank.mean=rowMeans(rk.period)
)
result=data.frame(mse=rowMeans(sfe),
rmse=mse^.5,
rank.mean=rowMeans(rk.period)
)
result$rank.rmse=round(rank(rmse),0)
result$rank.rank.mean=round(rank(result$rank.mean),0)
result.mt=result[grep('MT.',row.names(result)),]
View(result.mt)
source('~/.active-rstudio-document', echo=TRUE)
View(result.mt)
View(data)
source('~/.active-rstudio-document', echo=TRUE)
View(result.mt)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
result=data.frame(mse=rowMeans(sfe),
rank.mean=rowMeans(rk.period)
)
result$rmse=mse^.5,
result$rank.rmse=round(rank(rmse),0)
result$rank.rank.mean=round(rank(result$rank.mean),0)
result$rank.rmse=round(rank(result$rmse),0)
result$rmse=result$mse^.5,
result$rmse=result$mse^.5
result$rank.rmse=round(rank(result$rmse),0)
result$rank.rank.mean=round(rank(result$rank.mean),0)
result.mt=result[grep('MT.',row.names(result)),]
View(result.mt)
write.csv(result.mt=paste('result',target,horizon,'.csv'))
write.csv(result.mt,paste('result',target,horizon,'.csv',sep=''))
write.csv(result.mt,paste(DirCode,'/results/results',target,horizon,'.csv',sep=''))
View(data)
View(data)
h
(86.5-88.4)/86.5*100
source('~/.active-rstudio-document', echo=TRUE)
View(data)
View(result.mt)
source('~/.active-rstudio-document', echo=TRUE)
source('H:/git/zeit-2/code/mti experiment main code/evaluation.R', echo=TRUE)
View(result.mt)
View(result)
View(data)
